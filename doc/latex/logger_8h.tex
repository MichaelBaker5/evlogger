\hypertarget{logger_8h}{\section{/\-Users/js39g13/projects/evlogger/src/logger.h File Reference}
\label{logger_8h}\index{/\-Users/js39g13/projects/evlogger/src/logger.\-h@{/\-Users/js39g13/projects/evlogger/src/logger.\-h}}
}


E\-V Datalogger Project.  


{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include $<$msp430.\-h$>$}\\*
{\ttfamily \#include $<$msp430f5529.\-h$>$}\\*
{\ttfamily \#include $<$legacymsp430.\-h$>$}\\*
{\ttfamily \#include \char`\"{}typedefs.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}ff.\-h\char`\"{}}\\*
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structRingBuffer}{Ring\-Buffer}
\begin{DoxyCompactList}\small\item\em A structure that emulates a ring buffer. \end{DoxyCompactList}\item 
struct \hyperlink{structSampleBuffer}{Sample\-Buffer}
\begin{DoxyCompactList}\small\item\em A structure to contain one 'set' of samples from the vehicle. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{group__logger_gac25d4bda2e5e60901d16ab23fab5f324}{S1\-\_\-\-P\-O\-R\-T\-\_\-\-O\-U\-T}~P1\-O\-U\-T
\item 
\#define \hyperlink{group__logger_gae1407069d60d2d9d6d43e0d872fe5066}{S1\-\_\-\-P\-O\-R\-T\-\_\-\-R\-E\-N}~P1\-R\-E\-N
\item 
\#define \hyperlink{group__logger_gac543535dbf43aab36ae46b652ac88cee}{S1\-\_\-\-P\-O\-R\-T\-\_\-\-I\-E\-S}~P1\-I\-E\-S
\item 
\#define \hyperlink{group__logger_ga5635524194bbc8911288f76fc0bb6b5b}{S1\-\_\-\-P\-O\-R\-T\-\_\-\-I\-E}~P1\-I\-E
\item 
\#define \hyperlink{group__logger_ga6dab5a96841f65e53b65fc30d25e987c}{S1\-\_\-\-P\-O\-R\-T\-\_\-\-I\-F\-G}~P1\-I\-F\-G
\item 
\#define \hyperlink{group__logger_ga8766620bcdd3b4ffdae69e99def6458e}{S1\-\_\-\-P\-I\-N}~\hyperlink{typedefs_8h_a483c9de27db573099572f5485ef841c9}{\-\_\-\-B\-V}(7)
\item 
\#define \hyperlink{group__logger_ga7d2c3ed889c26e408d9760010877c743}{S2\-\_\-\-P\-O\-R\-T\-\_\-\-O\-U\-T}~P2\-O\-U\-T
\item 
\#define \hyperlink{group__logger_ga145401ccd2b64b0b27f08e3b7f290d2a}{S2\-\_\-\-P\-O\-R\-T\-\_\-\-R\-E\-N}~P2\-R\-E\-N
\item 
\#define \hyperlink{group__logger_gaf4e0d6be993eceb8be68f0225e347b0c}{S2\-\_\-\-P\-O\-R\-T\-\_\-\-I\-E\-S}~P2\-I\-E\-S
\item 
\#define \hyperlink{group__logger_gac36c10134cfc6b2f1b6c505246a14edc}{S2\-\_\-\-P\-O\-R\-T\-\_\-\-I\-E}~P2\-I\-E
\item 
\#define \hyperlink{group__logger_gada0fb6bcf89f5f8c0dd989f63a3a5abf}{S2\-\_\-\-P\-O\-R\-T\-\_\-\-I\-F\-G}~P2\-I\-F\-G
\item 
\#define \hyperlink{group__logger_gad50338afe7b10c1aa188fde925109853}{S2\-\_\-\-P\-I\-N}~\hyperlink{typedefs_8h_a483c9de27db573099572f5485ef841c9}{\-\_\-\-B\-V}(2)
\item 
\#define \hyperlink{group__logger_gafacd61cc6eb6a06283bfc5a9824e0760}{S\-D\-\_\-\-R\-I\-N\-G\-B\-U\-F\-\_\-\-L\-E\-N}~2048
\begin{DoxyCompactList}\small\item\em Ring buffer length for the S\-D card, should be a multiple of 2 of the sector size (512 bytes) \end{DoxyCompactList}\item 
\#define \hyperlink{group__logger_gaa92c48a4b6b3ea015e31a01e940c440b}{S\-D\-\_\-\-R\-I\-N\-G\-B\-U\-F\-\_\-\-M\-A\-S\-K}~(\hyperlink{group__logger_gafacd61cc6eb6a06283bfc5a9824e0760}{S\-D\-\_\-\-R\-I\-N\-G\-B\-U\-F\-\_\-\-L\-E\-N} -\/ 1)
\item 
\#define \hyperlink{group__logger_ga065dcfa648ca52ed6214008cb177de36}{A\-D\-C\-\_\-\-C\-H\-A\-N\-N\-E\-L\-S}~7
\begin{DoxyCompactList}\small\item\em The number of A\-D\-C channels that we will sample from. \end{DoxyCompactList}\item 
\#define \hyperlink{group__logger_ga97ed3fe57790c99c8e351a42713c604d}{A\-C\-C\-E\-L\-\_\-\-C\-H\-A\-N\-N\-E\-L\-S}~3
\begin{DoxyCompactList}\small\item\em The number of accelerometer channels (typically 3) to be sampled from. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structRingBuffer}{Ring\-Buffer} \hyperlink{group__logger_gacc8f6cda4a415098348d3e3c222b2ac6}{Ring\-Buffer}
\item 
typedef struct \hyperlink{structSampleBuffer}{Sample\-Buffer} \hyperlink{group__logger_ga04b1abe6e9526dc4f1c490318dc72f78}{Sample\-Buffer}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{group__logger_ga7f0a1ef369c8017a21abc0f68371b64e}{logger\-\_\-init} (void)
\begin{DoxyCompactList}\small\item\em Set up the hardware for logging functionality, including the configuration of required peripherals such as the A\-D\-C and Accelerometer. \end{DoxyCompactList}\item 
void \hyperlink{group__logger_gae7aec9e9b6c4a25bda9ff4b5498aedee}{sd\-\_\-setup} (\hyperlink{structRingBuffer}{Ring\-Buffer} $\ast$\hyperlink{group__logger_gad897897d6e8cd86086d5ebaa9a21d0d4}{sdbuf})
\begin{DoxyCompactList}\small\item\em Set up the S\-D card for logging to it. \end{DoxyCompactList}\item 
F\-R\-E\-S\-U\-L\-T \hyperlink{group__logger_gad722dfdb4da7ee009462dde1a83f4358}{sd\-\_\-write} (\hyperlink{structRingBuffer}{Ring\-Buffer} $\ast$rb, char $\ast$\hyperlink{group__logger_ga8e106526932e3c95b903409ab35b0882}{writebuf}, F\-I\-L $\ast$\hyperlink{group__logger_ga4be63952e3c9cb0f46f9e592b3c78714}{fil}, \hyperlink{typedefs_8h_a1f1825b69244eb3ad2c7165ddc99c956}{uint16\-\_\-t} n)
\begin{DoxyCompactList}\small\item\em Write n bytes from a ring buffer to an S\-D card controlled by fatfs. \end{DoxyCompactList}\item 
\hyperlink{typedefs_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\-\_\-t} \hyperlink{group__logger_gab8bdf9f19d8d4ebacc793b22afd90768}{ringbuf\-\_\-write} (\hyperlink{structRingBuffer}{Ring\-Buffer} $\ast$buf, char $\ast$data, \hyperlink{typedefs_8h_a1f1825b69244eb3ad2c7165ddc99c956}{uint16\-\_\-t} n)
\begin{DoxyCompactList}\small\item\em Write n bytes to a ring buffer. \end{DoxyCompactList}\item 
\hyperlink{typedefs_8h_aba7bc1797add20fe3efdf37ced1182c5}{uint8\-\_\-t} \hyperlink{group__logger_ga78ecc0240d02beed08b04f5c69dd3f2c}{ringbuf\-\_\-read} (\hyperlink{structRingBuffer}{Ring\-Buffer} $\ast$buf, char $\ast$read\-\_\-buffer, \hyperlink{typedefs_8h_a1f1825b69244eb3ad2c7165ddc99c956}{uint16\-\_\-t} n)
\begin{DoxyCompactList}\small\item\em Read n bytes from a ring buffer. \end{DoxyCompactList}\item 
void \hyperlink{group__logger_gaf8a40257f5965ff6dd711c8b3923e4d1}{update\-\_\-lcd} (\hyperlink{structRingBuffer}{Ring\-Buffer} $\ast$buf)
\begin{DoxyCompactList}\small\item\em Update the L\-C\-D with the current status of the logger service. \end{DoxyCompactList}\item 
void \hyperlink{group__logger_gadf69ccbc6389e013322d06a0516d9db5}{logger\-\_\-enable} (void)
\begin{DoxyCompactList}\small\item\em Enable T\-A1 to begin logging by setting mode control to \char`\"{}up\char`\"{} mode, counter counts to T\-Ax\-C\-C\-R0. \end{DoxyCompactList}\item 
void \hyperlink{group__logger_gaeb449c011f90affd5c104e98298704b5}{logger\-\_\-disable} (void)
\begin{DoxyCompactList}\small\item\em Disable T\-A1 to halt logging by setting mode control to S\-T\-O\-P. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
E\-V Datalogger Project. Jon Sowman 2014 \href{mailto:js39g13@soton.ac.uk}{\tt js39g13@soton.\-ac.\-uk} University of Southampton

\begin{DoxyAuthor}{Author}
Jon Sowman 
\end{DoxyAuthor}
